# Lexicon AI 知识库系统

## 🚨 重要更新：乱码问题修复

### 问题背景
之前版本中，PDF和Word文档的二进制内容被错误地当作文本处理，导致知识库中出现大量乱码条目。

### 修复措施
1. **文件格式限制**：现在仅支持纯文本文件(.txt)
2. **内容验证机制**：自动检测和阻止二进制内容处理
3. **智能清理功能**：一键清理现有乱码条目
4. **用户指导**：详细的文档转换说明

### 如何使用

#### 1. 文件准备
**支持的格式**：
- ✅ 纯文本文件(.txt)

**不支持的格式**：
- ❌ PDF文件(.pdf) 
- ❌ Word文档(.doc/.docx)

**转换方法**：
1. **复制粘贴法**（推荐）：
   - 打开PDF或Word文档
   - 选择并复制内容
   - 粘贴到记事本等文本编辑器
   - 保存为.txt文件

2. **另存为法**：
   - Word：文件 → 另存为 → 纯文本(.txt)
   - PDF：使用Adobe Reader等导出为文本

3. **在线转换**：
   - 使用PDF.io、SmallPDF等工具
   - 将PDF转换为文本文件

#### 2. 清理现有乱码
如果您的知识库中已有乱码条目：

1. 进入知识库页面
2. 点击右上角"清理乱码"按钮
3. 确认删除操作
4. 系统会自动检测并删除乱码条目

**清理检测条件**：
- 包含PDF格式标记（endstream、endobj等）
- 包含大量控制字符或二进制数据
- 标题中特殊字符比例超过30%

#### 3. 处理模式选择

**AI模式**（智能但较慢）：
- 高质量知识提取
- 智能分类和关键词
- 可能受配额限制

**手动模式**（快速但基础）：
- 即时处理完成
- 基于文档结构解析
- 不受AI配额限制

### 使用建议

1. **文档预处理**：
   - 确保文档格式清晰
   - 有明确的标题层次
   - 去除不必要的格式符号

2. **处理策略**：
   - 小文档(<300KB)：优先AI模式
   - 大文档(>1MB)：建议手动模式
   - 遇到429错误：立即切换手动模式

3. **质量保证**：
   - 定期检查知识条目质量
   - 手动编辑不准确的条目
   - 利用搜索功能快速定位内容

### 故障排除

**常见问题**：

1. **上传失败**："文件似乎包含二进制数据"
   - 解决：确认文件是纯文本格式
   - 重新转换文档为.txt格式

2. **AI服务不可用**
   - 解决：切换到手动模式继续工作
   - 等待配额恢复后再使用AI模式

3. **提取质量不理想**
   - 解决：优化文档结构和格式
   - 尝试不同的处理模式
   - 手动编辑提取结果

### 技术特性

- **双重验证**：文件类型 + 内容质量检查
- **智能清理**：自动识别和删除乱码条目
- **渐进式降级**：AI不可用时自动切换手动模式
- **实时反馈**：详细的处理状态和错误提示

这个修复确保了系统的稳定性和数据质量，避免了乱码问题的再次出现。

## 📚 文档列表

### 核心文档
- [项目蓝图](blueprint.md) - 应用的愿景和设计理念
- [修改指南](modification-guide.md) - 如何修改词汇和对话内容的详细说明
- [快速参考](quick-reference.md) - 常用信息和快速查询

### 对话相关文档
- [对话分类整理](dialogue-categories.md) - 所有对话场景的详细分类和统计
- [对话库概览](dialogue-library-summary.md) - 对话库的总体介绍
- [对话快速指南](dialogue-quick-guide.md) - 对话学习的快速入门
- [对话导入报告](dialogue-import-report.md) - 对话内容导入情况说明

## 🎯 使用建议

1. 新用户建议先阅读[项目蓝图](blueprint.md)了解整体设计
2. 需要修改内容时参考[修改指南](modification-guide.md)
3. 日常使用查阅[快速参考](quick-reference.md)
4. 了解对话内容请查看[对话分类整理](dialogue-categories.md)

## 📝 文档维护

如需更新文档，请遵循以下原则：
- 保持文档简洁明了
- 使用 Markdown 格式
- 及时更新内容变更
- 添加实用示例

## 快速链接

- 修改词汇和对话：查看 [modification-guide.md](./modification-guide.md#修改词汇)
- 更换图片和图标：查看 [modification-guide.md](./modification-guide.md#修改图片)
- 了解项目愿景：查看 [blueprint.md](./blueprint.md)

## 其他资源

- 主项目 README：[../README.md](../README.md)
- 源代码：[../src/](../src/)
- 数据文件：[../src/lib/data.ts](../src/lib/data.ts) 