rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // ğŸš§ å¼€å‘æµ‹è¯•æ¨¡å¼ - å…è®¸æ‰€æœ‰è®¤è¯ç”¨æˆ·è¯»å†™æ•°æ®
    // âš ï¸ ç”Ÿäº§ç¯å¢ƒå‰å¿…é¡»ä¿®æ”¹ä¸ºä¸¥æ ¼æƒé™æ§åˆ¶
    
    // ç”¨æˆ·æ•°æ® - å¼€å‘é˜¶æ®µå…è®¸æ‰€æœ‰è®¤è¯ç”¨æˆ·è®¿é—®
    match /users/{userId} {
      allow read, write: if request.auth != null;
      
      // ç”¨æˆ·çš„è‡ªå®šä¹‰è¯æ±‡åŒ…
      match /customVocabularyPacks/{packId} {
        allow read, write: if request.auth != null;
      }
      
      // ç”¨æˆ·çš„è‡ªå®šä¹‰å¯¹è¯
      match /customDialogues/{dialogueId} {
        allow read, write: if request.auth != null;
      }
      
      // æµ‹è¯•æ–‡æ¡£ï¼ˆç”¨äºè°ƒè¯•ï¼‰
      match /test/{document} {
        allow read, write: if request.auth != null;
      }
    }
    
    // å…¨å±€æµ‹è¯•é›†åˆ - å¼€å‘é˜¶æ®µå®Œå…¨å¼€æ”¾
    match /test/{document=**} {
      allow read, write: if true;
    }
    
    // å…¬å…±è¯æ±‡åŒ…é›†åˆ - æ‰€æœ‰è®¤è¯ç”¨æˆ·å¯ä»¥è¯»å†™
    match /publicVocabularyPacks/{document} {
      allow read, write: if request.auth != null;
    }
    
    // å…¬å…±å¯¹è¯é›†åˆ - æ‰€æœ‰è®¤è¯ç”¨æˆ·å¯ä»¥è¯»å†™
    match /publicDialogues/{document} {
      allow read, write: if request.auth != null;
    }
    
    // æ™ºèƒ½å¯¹è¯ä¼šè¯ - ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„ä¼šè¯
    match /chatSessions/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    
    // å¼€å‘é˜¶æ®µï¼šå…è®¸è®¤è¯ç”¨æˆ·è®¿é—®æ‰€æœ‰å…¶ä»–é›†åˆ
    // è¿™åŒ…æ‹¬å¯èƒ½çš„æ–°åŠŸèƒ½æµ‹è¯•é›†åˆ
    match /{document=**} {
      allow read, write: if request.auth != null;
    }
  }
} 